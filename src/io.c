/*----------------------------------------------------------------------------*/
/*
 *  Ryan Sullivan
 *
 *  Module Name     : io.c
 *  Description     : io functions
 */
/*----------------------------------------------------------------------------*/

#include "types.h"

#include "io.h"
#include "port.h"

/*----------------------------------------------------------------------------*/
/*-constant-definitions-------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

#define DEBUG_LED2  PORT_E5
#define DEBUG_LED1  PORT_E6

/*----------------------------------------------------------------------------*/
/*-exported-variables---------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*-static-variables-----------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

uint16_t    timer = 0;
bool        debug_led1_on = false;

/*----------------------------------------------------------------------------*/
/*-forward-declarations-------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

void    port_initialise(void);

/*----------------------------------------------------------------------------*/
/*-exported-functions---------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

void io_initialise(void)
{
    port_initialise();
}

/*----------------------------------------------------------------------------*/

/*
 * @brief turn on a debug led
 * 
 * @param led   led to turn on, 1 or 2
 */
void io_debug_led_on(uint8_t led)
{
    if(led == 1)
    {
        port_set(DEBUG_LED1);
    }
    else if(led == 2)
    {
        port_set(DEBUG_LED2);
    }
    else
    {

    }
}

/*----------------------------------------------------------------------------*/

/*
 * @brief turn off a debug led
 * 
 * @param led   led to turn off, 1 or 2
 */
void io_debug_led_off(uint8_t led)
{
    if(led == 1)
    {
        port_clear(DEBUG_LED1);
    }
    else if(led == 2)
    {
        port_clear(DEBUG_LED2);
    }
    else
    {

    }
}

/*----------------------------------------------------------------------------*/

void io_poll(void)
{
    timer++;
    if(timer > 1000 )
    {
        timer = 0;
        if(debug_led1_on == true)
        {
            debug_led1_on = false;
            port_clear(DEBUG_LED1);
        }
        else
        {
            debug_led1_on = true;
            port_set(DEBUG_LED1);
        }
    }
}

/*----------------------------------------------------------------------------*/
/*-static-functions-----------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

void port_initialise(void)
{
    port_initialise_pin(DEBUG_LED1, PORT_MODE_PUSH_PULL);
    port_initialise_pin(DEBUG_LED2, PORT_MODE_PUSH_PULL);
}

/*----------------------------------------------------------------------------*/
/*-end-of-module--------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
